<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Greekaway – Βήμα 3</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/footer-rounded.css">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/step3.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#001f3f">
  <link rel="stylesheet" href="/pwa.css">
  <link rel="stylesheet" href="/css/pwa-fixes.css">
</head>
<body class="site-gradient">
  
  <div class="step3-header">
    <div class="trip-title" id="s3TripTitle">&nbsp;</div>
    <div class="step-indicator" style="margin-top:6px;color:var(--color-gold,#d9b85f);font-weight:700;opacity:.9" data-i18n="booking.step3_of3">Βήμα 3 από 3</div>
  </div>

  <div class="step3-band" aria-hidden="true">
    <div class="step3-card"></div>
  </div>

  <div id="s3Error" hidden data-i18n="booking.traveler_profile_incomplete">Please complete your traveler profile before continuing.</div>
  <div class="s3-summary">
    <div class="s3-card">
  <div class="s3-row"><div class="s3-label" data-i18n="booking.adults">Ενήλικες</div><div class="s3-value" id="vAdults">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.children">Παιδιά</div><div class="s3-value" id="vChildren">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.suitcases">Αποσκευές</div><div class="s3-value" id="vBags">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.preferred_language">Γλώσσα επικοινωνίας</div><div class="s3-value" id="vLang">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.pickup_location">Σημείο Παραλαβής</div><div class="s3-value" id="vPickup">–</div></div>
  <div class="s3-row" id="vNotesInfoRow" hidden><div class="s3-label"></div><div class="s3-value" id="vNotesInfo">—</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.age_group">Ηλικιακή ομάδα</div><div class="s3-value" id="vAgeGroup">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.traveler_type">Τύπος ταξιδιώτη</div><div class="s3-value" id="vTravelerType">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.interests">Ενδιαφέροντα</div><div class="s3-value" id="vInterest">–</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.sociality">Κοινωνικότητα</div><div class="s3-value" id="vSocial">–</div></div>
  <div class="s3-row emph"><div class="s3-label" data-i18n="booking.trip_cost">Κόστος εκδρομής</div><div class="s3-value" id="vTripCost">–</div></div>
    </div>
  </div>

  <div class="s3-actions">
    <button id="s3Back" class="btn" data-i18n="ui.back">Πίσω</button>
    <button id="s3ProceedPay" class="btn" data-i18n="booking.proceed_payment">Πληρωμή</button>
  </div>

  <!-- Overlays: About, AI, Profile for consistent footer actions -->
  <div id="aboutOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('aboutOverlay')" aria-label="Κλείσιμο">×</button>
    <div class="overlay-inner">
      <h2 data-i18n="about.title">Σχετικά με εμάς</h2>
      <p data-i18n="about.text">Το Greekaway δημιουργήθηκε για να σας προσφέρει επιλεγμένες εκδρομές στην Ελλάδα με άνεση, τεχνολογία και στυλ.</p>
    </div>
  </div>

  <div id="aiOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('aiOverlay')" aria-label="Κλείσιμο">×</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.ai">Βοηθός AI</h2>
      <p data-i18n="welcome.ask">Ρωτήστε μας ό,τι θέλετε για την εκδρομή σας!</p>
    </div>
  </div>

  <div id="profileOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('profileOverlay')" aria-label="Κλείσιμο">×</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.profile">Το Προφίλ μου</h2>
      <p data-i18n="profile.info">Εδώ θα δείτε τις εκδρομές που έχετε κάνει και τις κρατήσεις σας.</p>
    </div>
  </div>

  <footer>
    <a href="/index.html"><i class="fas fa-home"></i><span data-i18n="nav.home">Home</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('aboutOverlay')"><i class="fas fa-info-circle"></i><span data-i18n="nav.about">About Us</span></a>
    <a href="javascript:void(0)" class="central-btn"><i class="fas fa-bell"></i><span data-i18n="nav.book">Κράτηση</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('aiOverlay')"><i class="fas fa-comments"></i><span data-i18n="nav.ai">AI Assistant</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('profileOverlay')"><i class="fas fa-user"></i><span data-i18n="nav.profile">Προφίλ</span></a>
  </footer>

  <!-- Load i18n first and add cache-busting -->
  <script src="/js/i18n.js?v=20251022" defer></script>
  <script src="/js/overlay-manager.js?v=2" defer></script>
  <script src="/js/assistant.js?v=2" defer></script>
  <script src="/pwa-install.js" defer></script>
  <script>
    try { document.body.classList.add('has-rounded-footer'); } catch(_){ }
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // Safe i18n accessor: if translation not ready or equals key, return fallback
      function tSafe(key, fallback){
        try { const v = (window.t && window.t(key)) || ''; return (v && v !== key) ? v : fallback; } catch(_){ return fallback; }
      }

      // Helper: load trip details by id and update cost immediately when ready
      async function loadTripAndUpdate(tripId){
        if (!tripId) return;
        try {
          let dv = '';
          try {
            const rv = await fetch('/version.json', { cache: 'no-cache' });
            if (rv.ok) {
              const j = await rv.json();
              dv = j && j.dataVersion ? ('?v=' + encodeURIComponent(String(j.dataVersion))) : '';
            }
          } catch(_) {}
          const r = await fetch(`/data/trips/${encodeURIComponent(tripId)}.json${dv}`, { cache: 'no-cache' });
          if (!r.ok) return;
          const trip = await r.json();
          try { window.__loadedTrip = trip; } catch(_) {}
          try { renderTripCost(); } catch(_) {}
          return trip;
        } catch(_) { /* silent */ }
      }

      try {
        const t = sessionStorage.getItem('gw_trip_title') || '';
        const id = sessionStorage.getItem('gw_trip_id') || '';
        if (t) {
          const el = document.getElementById('s3TripTitle');
          if (el) el.textContent = t;
          // Even if title exists, ensure we fetch the trip for accurate pricing
          loadTripAndUpdate(id);
        } else if (id) {
          (async function(){
            try {
              let dv = '';
              try { const rv = await fetch('/version.json', { cache: 'no-cache' }); if (rv.ok) { const j = await rv.json(); dv = j && j.dataVersion ? ('?v='+encodeURIComponent(String(j.dataVersion))) : ''; } } catch(_){ }
              const r = await fetch(`/data/trips/${encodeURIComponent(id)}.json${dv}`, { cache: 'no-cache' });
              if (!r.ok) return;
              const trip = await r.json();
              try { window.__loadedTrip = trip; } catch(_){ }
              const lang = (localStorage.getItem('gw_lang') || 'el');
              const getLocalized = (field) => {
                if (!field) return '';
                if (typeof field === 'string') return field;
                if (typeof field === 'object') return field[lang] || field['el'] || Object.values(field)[0] || '';
                return '';
              };
              const title = getLocalized(trip.title);
              if (title) document.getElementById('s3TripTitle').textContent = title;
              try { renderTripCost(); } catch(_) {}
            } catch(_){ }
          })();
        }
  } catch(_){ }

      const get = (k, d='')=>{ 
        try { 
          let v = sessionStorage.getItem(k);
          if (v == null) v = localStorage.getItem(k);
          return v == null ? d : v; 
        } catch(_){ return d; } 
      };
  const langFlags = { el:'🇬🇷', en:'🇬🇧', fr:'🇫🇷', de:'🇩🇪', it:'🇮🇹', es:'🇪🇸', zh:'🇨🇳', he:'🇮🇱', nl:'🇳🇱', sv:'🇸🇪', ko:'🇰🇷', pt:'🇵🇹', ru:'🇷🇺' };
  const travTypeFallback = { explore:'Εξερευνητές – δραστήριοι', relax:'Χαλαροί ταξιδιώτες', family:'Οικογενειακό ύφος', solo:'Μοναχικοί ταξιδιώτες' };
  const interestFallback = { nature:'Φύση', culture:'Πολιτισμός', mountain:'Βουνό', sea:'Θάλασσα', gastronomy:'Γαστρονομία' };
  const langFallbackLabels = { el:'Ελληνικά', en:'English', fr:'Français', de:'Deutsch', it:'Italiano', es:'Español', zh:'中文', he:'עברית', nl:'Nederlands', sv:'Svenska', ko:'한국어', pt:'Português', ru:'Русский' };

      const adults = get('gw_adults','2');
  const ages = (()=>{ try { return JSON.parse(get('gw_children_ages','[]')); } catch(_){ return []; } })();
  const children = String(ages.length);
  const bagsL = parseInt(get('gw_bags_large','0'),10)||0;
  const bagsM = parseInt(get('gw_bags_medium','0'),10)||0;
  const bagsS = parseInt(get('gw_bags_small','0'),10)||0;
  const totalBags = bagsL + bagsM + bagsS;
  // Communication preference: prefer explicit booking preference, fallback to global UI language
  const langC = (() => { const v = get('gw_pref_lang',''); return v || get('gw_lang','el'); })();
      const ageG = get('gw_age_group','');
      const travT = get('gw_traveler_type','');
      const interest = get('gw_interest','');
      const social = get('gw_sociality','');

      function renderValues(){
  document.getElementById('vAdults').textContent = adults;
  // Display children as "N (a-b-c)" when ages exist, otherwise dash
  document.getElementById('vChildren').textContent = ages.length ? (children + ' (' + ages.join('-') + ')') : '—';
        if (totalBags) {
          const parts = [];
          if (bagsS) parts.push(`${bagsS}S`);
          if (bagsM) parts.push(`${bagsM}M`);
          if (bagsL) parts.push(`${bagsL}L`);
          const detail = parts.join(' · ');
          document.getElementById('vBags').textContent = detail ? `${totalBags} (${detail})` : String(totalBags);
        } else {
          document.getElementById('vBags').textContent = '—';
        }
        const langLabel = tSafe('booking.preferred_language_options.' + langC, (langFallbackLabels[langC] || langC.toUpperCase()));
        const langFlag = langFlags[langC] || '';
        document.getElementById('vLang').textContent = langLabel ? (langFlag ? `${langFlag} ${langLabel}` : langLabel) : '—';
        // Determine pickup address: for bus mode always use trip's fixed start location
        (function(){
          function getTripMode(){
            try { const p=new URLSearchParams(window.location.search); return (p.get('mode')||localStorage.getItem('trip_mode')||'van').toLowerCase(); } catch(_){ return 'van'; }
          }
          function getBusFixedAddress(){
            // Prefer loaded trip JSON
            try {
              const trip = (window.__loadedTrip || null);
              const depName = trip && trip.departure && trip.departure.reference_point && trip.departure.reference_point.name;
              if (depName && String(depName).trim()) return String(depName).trim();
            } catch(_){ }
            // Next, any value persisted by Step 1 trip page
            try { const v = localStorage.getItem('bus_pickup_address'); if (v && v.trim()) return v.trim(); } catch(_){ }
            // Finally, whatever is in session from Step 2
            try { const s = sessionStorage.getItem('gw_pickup_address'); if (s && s.trim()) return s.trim(); } catch(_){ }
            return '';
          }
          const mode = getTripMode();
          const val = (mode === 'bus') ? getBusFixedAddress() : (get('gw_pickup_address','') || '');
          document.getElementById('vPickup').textContent = (val || '—');
        })();
        document.getElementById('vAgeGroup').textContent = ageG || '—';
        const travLabel = travT ? tSafe('booking.traveler_type_options.' + travT, (travTypeFallback[travT] || '—')) : '—';
        const intLabel = interest ? tSafe('booking.interests_options.' + interest, (interestFallback[interest] || '—')) : '—';
        const socLabel = social ? tSafe('booking.sociality_options.' + social, (social === 'social' ? 'Κοινωνικός' : social === 'quiet' ? 'Ήσυχος' : '—')) : '—';
        document.getElementById('vTravelerType').textContent = travLabel;
        document.getElementById('vInterest').textContent = intLabel;
        document.getElementById('vSocial').textContent = socLabel;
        // Show privacy-preserving message if special requests exist
        try {
          const notes = (get('gw_notes','') || '').trim();
          const row = document.getElementById('vNotesInfoRow');
          const el = document.getElementById('vNotesInfo');
          if (notes && row && el) {
            const msg = tSafe('booking.driver_message_updated','✅ μήνυμα του οδηγού ενημερώθηκε');
            el.textContent = msg;
            row.hidden = false;
          } else if (row) { row.hidden = true; }
        } catch(_){}
        try { renderTripCost(); } catch(_){}
      }

      function renderTripCost(){
        try {
          const trip = (window.__loadedTrip || null);
          const seats = (parseInt(adults||'0',10) || 0) + (parseInt(children||'0',10) || 0);
          let baseCents = 5000; // fallback base price (in cents)
          let cur = 'EUR';
          if (trip) {
            if (trip.price_cents != null) baseCents = Math.max(0, parseInt(trip.price_cents,10) || 0);
            if (trip.currency) cur = String(trip.currency).toUpperCase();
          }
          // Vehicle dynamic override: if user selected a vehicle-specific price earlier (Step 0/1)
          try {
            const sel = sessionStorage.getItem('selectedVehiclePrice');
            if (sel) {
              const euros = parseFloat(sel);
              if (!isNaN(euros) && euros > 0) {
                baseCents = Math.round(euros * 100);
              }
            }
          } catch(_){ }
          const totalCents = Math.max(0, baseCents * Math.max(1, seats));
          const val = (totalCents/100).toLocaleString((window.currentI18n && window.currentI18n.lang) || (navigator.language||'el'), { style:'currency', currency: cur });
          const el = document.getElementById('vTripCost'); if (el) el.textContent = val;
          // persist intended amount so checkout can use it if booking creation fails (last resort)
          try { sessionStorage.setItem('gw_amount_cents', String(totalCents)); } catch(_){ }
          try { sessionStorage.setItem('gw_currency', cur.toLowerCase()); } catch(_){ }
        } catch(_){ }
      }

      // Ensure the "trip cost" label translates explicitly even if auto-scan misses it
      function translateTripCostLabel(){
        try {
          const el = document.querySelector('[data-i18n="booking.trip_cost"]');
          if (!el) return;
          const tx = (window.t && window.t('booking.trip_cost')) || '';
          if (tx && tx !== 'booking.trip_cost') el.textContent = tx;
        } catch(_){ }
      }

      // When UI language changes, re-render the trip title using loaded trip or fetch by id
      try {
        window.addEventListener('i18n:changed', async () => {
          try {
            const titleEl = document.getElementById('s3TripTitle');
            const lang = (window.currentI18n && window.currentI18n.lang) || localStorage.getItem('gw_lang') || 'el';
            const getLocalized = (field) => {
              if (!field) return '';
              if (typeof field === 'string') return field;
              if (typeof field === 'object') return field[lang] || field['el'] || Object.values(field)[0] || '';
              return '';
            };
            let trip = (window.__loadedTrip || null);
            let tripId = (sessionStorage.getItem('gw_trip_id') || '');
            if (!trip && tripId) {
              trip = await loadTripAndUpdate(tripId);
            }
            if (trip && titleEl) {
              const title = getLocalized(trip.title);
              if (title) titleEl.textContent = title;
            }
            try { renderTripCost(); } catch(_) {}
          } catch(_){ }
        });
      } catch(_){ }
  renderValues();
  try { translateTripCostLabel(); } catch(_){}

      document.getElementById('s3Back')?.addEventListener('click', ()=> history.back());

      function getTripMode(){
        try {
          const p = new URLSearchParams(window.location.search);
          return (p.get('mode') || localStorage.getItem('trip_mode') || 'van').toLowerCase();
        } catch(_) { return 'van'; }
      }
      function validateProfile(){
        const mode = getTripMode();
        const errBox = document.getElementById('s3Error');
        const ageRow = document.querySelector('#vAgeGroup')?.closest('.s3-row');
        const travRow = document.querySelector('#vTravelerType')?.closest('.s3-row');
        if (mode === 'bus') {
          // Bypass profile validation for bus mode; ensure no red states
          try { errBox?.setAttribute('hidden',''); ageRow?.classList.remove('required'); travRow?.classList.remove('required'); } catch(_){}
          return true;
        }
        const ageG = get('gw_age_group','').trim();
        const travT = get('gw_traveler_type','').trim();
        let ok = true;
        if (!ageG){ ok = false; ageRow?.classList.add('required'); } else { ageRow?.classList.remove('required'); }
        if (!travT){ ok = false; travRow?.classList.add('required'); } else { travRow?.classList.remove('required'); }
        if (!ok) { errBox?.removeAttribute('hidden'); }
        else { errBox?.setAttribute('hidden',''); }
        return ok;
      }

      document.getElementById('s3ProceedPay')?.addEventListener('click', async (ev)=>{
        try { ev.preventDefault(); } catch(_){ }
        const btn = document.getElementById('s3ProceedPay'); if (btn) btn.disabled = true;
        if (!validateProfile()) { if (btn) btn.disabled=false; return; }
        try {
          // Build booking payload using stored selections and loaded trip
          const tripId = (sessionStorage.getItem('gw_trip_id') || '').trim();
          let trip = (window.__loadedTrip || null);
          if (!trip && tripId) {
            try {
              let dv = '';
              try { const rv = await fetch('/version.json', { cache: 'no-cache' }); if (rv.ok) { const j = await rv.json(); dv = j && j.dataVersion ? ('?v='+encodeURIComponent(String(j.dataVersion))) : ''; } } catch(_){ }
              const r = await fetch(`/data/trips/${encodeURIComponent(tripId)}.json${dv}`, { cache: 'no-cache' });
              if (r.ok) trip = await r.json();
            } catch(_){ }
          }
          const seats = (parseInt(adults||'0',10) || 0) + (parseInt(children||'0',10) || 0) || 1;
          const baseCents = trip && trip.price_cents ? Math.max(0, parseInt(trip.price_cents,10)||0) : 5000;
          const currency = (trip && trip.currency ? String(trip.currency).toLowerCase() : 'eur');
          const price_cents = Math.max(0, baseCents * seats);
          const mode = getTripMode();
          const payload = {
            trip_id: tripId,
            date: null,
            seats,
            price_cents,
            currency,
            trip_mode: mode,
            language: (sessionStorage.getItem('gw_pref_lang') || localStorage.getItem('gw_pref_lang') || localStorage.getItem('gw_lang') || 'el'),
            travelerProfile: (sessionStorage.getItem('gw_traveler_type') || ''),
            travelStyle: (sessionStorage.getItem('gw_interest') || ''),
            preferredLanguage: (sessionStorage.getItem('gw_pref_lang') || localStorage.getItem('gw_pref_lang') || ''),
            travelTempo: (sessionStorage.getItem('gw_sociality') || ''),
            children_ages: (()=>{ try { return JSON.parse(sessionStorage.getItem('gw_children_ages')||'[]'); } catch(_){ return []; } })(),
            metadata: {
              trip_mode: mode,
              age_group: (sessionStorage.getItem('gw_age_group') || ''),
              traveler_type: (sessionStorage.getItem('gw_traveler_type') || ''),
              interest: (sessionStorage.getItem('gw_interest') || ''),
              sociality: (sessionStorage.getItem('gw_sociality') || ''),
              children_ages: (()=>{ try { return JSON.parse(sessionStorage.getItem('gw_children_ages')||'[]'); } catch(_){ return []; } })(),
              // For bus: force fixed start location from trip JSON; otherwise use state/session
              ...(function(){
                function getBusFixedAddress(){
                  try {
                    const t = (window.__loadedTrip || null);
                    const depName = t && t.departure && t.departure.reference_point && t.departure.reference_point.name;
                    if (depName && String(depName).trim()) return String(depName).trim();
                  } catch(_){ }
                  try { const v = localStorage.getItem('bus_pickup_address'); if (v && v.trim()) return v.trim(); } catch(_){ }
                  try { const s = sessionStorage.getItem('gw_pickup_address'); if (s && s.trim()) return s.trim(); } catch(_){ }
                  return '';
                }
                if (mode === 'bus') {
                  const addr = getBusFixedAddress();
                  return {
                    pickup_address: addr,
                    pickup_place_id: '',
                    pickup_lat: '',
                    pickup_lng: '',
                    pickup: addr,
                    pickup_point: addr
                  };
                } else {
                  return {
                    pickup_address: (sessionStorage.getItem('gw_pickup_address') || ''),
                    pickup_place_id: (sessionStorage.getItem('gw_pickup_place_id') || ''),
                    pickup_lat: (sessionStorage.getItem('gw_pickup_lat') || ''),
                    pickup_lng: (sessionStorage.getItem('gw_pickup_lng') || ''),
                    // Duplicate pickup_address under legacy keys so provider panel & dispatch emails display it
                    pickup: (sessionStorage.getItem('gw_pickup_address') || ''),
                    pickup_point: (sessionStorage.getItem('gw_pickup_address') || '')
                  };
                }
              })(),
              // Luggage summary (S/M/L) for provider visibility & email
              luggage: (function(){
                const s = parseInt(sessionStorage.getItem('gw_bags_small')||'0',10)||0;
                const m = parseInt(sessionStorage.getItem('gw_bags_medium')||'0',10)||0;
                const l = parseInt(sessionStorage.getItem('gw_bags_large')||'0',10)||0;
                const total = s+m+l;
                if (!total) return '';
                const parts = [];
                if (s) parts.push(s+'S');
                if (m) parts.push(m+'M');
                if (l) parts.push(l+'L');
                return total + (parts.length? ' ('+parts.join(' · ')+')' : '');
              })(),
              notes: (sessionStorage.getItem('gw_notes') || ''),
              special_requests: (sessionStorage.getItem('gw_notes') || '')
            }
          };
          let bookingId = '';
          try {
            const resp = await fetch('/api/bookings', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
            const j = await resp.json();
            if (resp.ok && j.bookingId) bookingId = j.bookingId;
          } catch(_){ }
          const origin = (window.location && window.location.origin) || (window.location.protocol + '//' + window.location.host) || '';
          const url = new URL('/checkout.html', origin || window.location.href);
          if (tripId) url.searchParams.set('trip', tripId);
          if (bookingId) url.searchParams.set('bookingId', bookingId);
          // Navigation
          try { window.location.assign(url.href); }
          catch(_e1){ try { window.location.href = url.href; } catch(_e2){ setTimeout(()=>{ window.location.href = url.href; }, 0); } }
        } finally {
          if (btn) btn.disabled = false;
        }
      });
      try { window.addEventListener('i18n:changed', () => { validateProfile(); }); } catch(_){ }

      // Ensure labels translate after i18n is ready and on future language changes
  try { if (window.currentI18n && window.setLanguage) { window.setLanguage(window.currentI18n.lang); translateTripCostLabel(); } } catch(_){ }
  try { setTimeout(()=>{ try { if (window.currentI18n && window.setLanguage) { window.setLanguage(window.currentI18n.lang); translateTripCostLabel(); } } catch(_){ } }, 60); } catch(_){ }
      try {
        window.addEventListener('i18n:changed', ()=>{ try { renderValues(); renderTripCost(); translateTripCostLabel(); } catch(_){ } });
      } catch(_){ }
    });
  </script>
  <script src="/js/feedback.js" defer></script>
  <script>try{ window.GWFeedbackPrompt && window.GWFeedbackPrompt.init && window.GWFeedbackPrompt.init(); }catch(e){}</script>
  <script src="/js/main.js"></script>
</body>
</html>
