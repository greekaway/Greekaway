<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Greekaway â€“ Î’Î®Î¼Î± 3</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    :root {
      --panel-top: 5vh;
      /* Reuse step2 surfaces for consistent look */
      --surface-band-top: rgba(84, 122, 176, 0.38);
      --surface-band-bot: rgba(54, 86, 136, 0.30);
      --surface-card-top: rgba(58, 78, 102, 0.98);
      --surface-card-bot: rgba(36, 50, 68, 0.98);
    }
    html, body { height: 100%; }
    body { margin: 0; background-image: var(--site-gradient); background-color: var(--site-bg-color); }

    /* Middle band (same palette as step2) */
    .step3-band {
      position: fixed; top: var(--panel-top); left: 50%; transform: translateX(-50%);
      width: min(780px, calc(100vw - 56px)); bottom: -80px; margin: 0; padding: 0; overflow: hidden; pointer-events: none;
      background: linear-gradient(180deg, var(--surface-band-top) 0%, var(--surface-band-bot) 100%);
      border-radius: 18px;
    }
    @media (max-width: 599px) { .step3-band { width: calc(100vw - 40px); } }

    /* Foreground card panel (like step2) */
    .step3-card {
      position: absolute; inset: 0; border-radius: 16px;
      background: linear-gradient(180deg, var(--surface-card-top) 0%, var(--surface-card-bot) 100%);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.055),
        inset 0 1px 0 rgba(255,255,255,0.07),
        inset 0 -1px 0 rgba(0,0,0,0.30),
        0 14px 28px -12px rgba(0,0,0,0.55),
        0 36px 80px -24px rgba(0,0,0,0.60);
    }

    /* Header */
    .step3-header { position: fixed; top: 0; left: 0; right: 0; display:flex; flex-direction:column; align-items:center; gap:6px; z-index:5; color:#e8edf2; padding: 8px 16px 0; text-align:center; }
    .step3-header .trip-title { font-weight: 800; font-size: clamp(1.44rem, 2.88vw + 0.96rem, 2.28rem); letter-spacing: 0.4px; text-shadow: 0 2px 16px rgba(0,0,0,0.35); }

    /* Summary fields */
    .s3-summary { position: fixed; left: 50%; transform: translateX(-50%); top: calc(var(--panel-top) + 36px); width: min(780px, calc(100vw - 56px)); z-index: 10; color: #0b1220; font-weight: 800; }
    @media (max-width: 599px) { .s3-summary { width: calc(100vw - 40px); } }
  .s3-card { margin: 12px; padding: 8px 6px; border-radius: 14px; background: transparent; color: #fff; }
  .s3-row { display:flex; align-items:center; justify-content:space-between; padding: 12px 16px; }
  .s3-row + .s3-row { border-top: 1px solid rgba(0,0,0,0.45); box-shadow: inset 0 1px 0 rgba(255,255,255,0.06); }
    .s3-label { color:#fff; font-weight:800; }
    .s3-value { color:#fff; opacity:0.95; font-weight:800; text-align:right; }

    /* Actions (like step2) */
  .s3-actions { position: fixed; left: 0; right: 0; bottom: calc(64px + env(safe-area-inset-bottom) + 32px); display:flex; justify-content:center; align-items:center; padding: 0 20px; gap:18px; z-index: 13001; max-width:520px; margin:0 auto; }
    @media (max-width: 599px) { .s3-actions { padding: 0 16px; bottom: calc(64px + env(safe-area-inset-bottom) + 34px); max-width: 440px; gap: 16px; } }
    .s3-actions .btn { background:#0E1520; color:#fff; border:1px solid rgba(255,255,255,0.16); border-radius:16px; padding:12px 18px; font-size:1.03rem; font-weight:800; letter-spacing:0.02em; min-width: 140px; box-shadow:0 10px 18px rgba(0,0,0,0.35), 0 4px 10px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.06), inset 0 -1px 0 rgba(0,0,0,0.28); cursor:pointer; }

  </style>
</head>
<body class="site-gradient">
  <div style="position:fixed;top:8px;right:12px;z-index:20050">
    <select id="langSelect" aria-label="Language"></select>
  </div>
  <div class="step3-header">
    <div class="trip-title" id="s3TripTitle">&nbsp;</div>
    <div class="step-indicator" style="margin-top:6px;color:var(--color-gold,#d9b85f);font-weight:700;opacity:.9" data-i18n="booking.step3_of3">Î’Î®Î¼Î± 3 Î±Ï€ÏŒ 3</div>
  </div>

  <div class="step3-band" aria-hidden="true">
    <div class="step3-card"></div>
  </div>

  <div class="s3-summary">
    <div class="s3-card">
  <div class="s3-row"><div class="s3-label" data-i18n="booking.adults">Î•Î½Î®Î»Î¹ÎºÎµÏ‚</div><div class="s3-value" id="vAdults">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.children">Î Î±Î¹Î´Î¹Î¬</div><div class="s3-value" id="vChildren">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.children_ages">Î—Î»Î¹ÎºÎ¯ÎµÏ‚ Ï€Î±Î¹Î´Î¹ÏÎ½</div><div class="s3-value" id="vChildrenAges">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.bags_large">Î’Î±Î»Î¯Ï„ÏƒÎµÏ‚ (ÎœÎµÎ³Î¬Î»ÎµÏ‚)</div><div class="s3-value" id="vBagsLarge">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.bags_small">Î’Î±Î»Î¯Ï„ÏƒÎµÏ‚ (ÎœÎ¹ÎºÏÎ­Ï‚)</div><div class="s3-value" id="vBagsSmall">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.preferred_language">Î“Î»ÏÏƒÏƒÎ± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚</div><div class="s3-value" id="vLang">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.age_group">Î—Î»Î¹ÎºÎ¹Î±ÎºÎ® Î¿Î¼Î¬Î´Î±</div><div class="s3-value" id="vAgeGroup">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.traveler_type">Î¤ÏÏ€Î¿Ï‚ Ï„Î±Î¾Î¹Î´Î¹ÏÏ„Î·</div><div class="s3-value" id="vTravelerType">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.interests">Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î±</div><div class="s3-value" id="vInterest">â€“</div></div>
  <div class="s3-row"><div class="s3-label" data-i18n="booking.sociality">ÎšÎ¿Î¹Î½Ï‰Î½Î¹ÎºÏŒÏ„Î·Ï„Î±</div><div class="s3-value" id="vSocial">â€“</div></div>
    </div>
  </div>

  <div class="s3-actions">
    <button id="s3Back" class="btn" data-i18n="ui.back">Î Î¯ÏƒÏ‰</button>
    <button id="s3Finish" class="btn" data-i18n="ui.finish">ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·</button>
  </div>

  <!-- Overlays: About, AI, Profile for consistent footer actions -->
  <div id="aboutOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('aboutOverlay')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="about.title">Î£Ï‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ ÎµÎ¼Î¬Ï‚</h2>
      <p data-i18n="about.text">Î¤Î¿ Greekaway Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î³Î¹Î± Î½Î± ÏƒÎ±Ï‚ Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½ÎµÏ‚ ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚ ÏƒÏ„Î·Î½ Î•Î»Î»Î¬Î´Î± Î¼Îµ Î¬Î½ÎµÏƒÎ·, Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± ÎºÎ±Î¹ ÏƒÏ„Ï…Î».</p>
    </div>
  </div>

  <div id="aiOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('aiOverlay')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.ai">Î’Î¿Î·Î¸ÏŒÏ‚ AI</h2>
      <p data-i18n="welcome.ask">Î¡Ï‰Ï„Î®ÏƒÏ„Îµ Î¼Î±Ï‚ ÏŒ,Ï„Î¹ Î¸Î­Î»ÎµÏ„Îµ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ´ÏÎ¿Î¼Î® ÏƒÎ±Ï‚!</p>
    </div>
  </div>

  <div id="profileOverlay" class="overlay" role="dialog" aria-modal="true" hidden>
    <button class="close-overlay" onclick="closeOverlay('profileOverlay')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.profile">Î¤Î¿ Î ÏÎ¿Ï†Î¯Î» Î¼Î¿Ï…</h2>
      <p data-i18n="profile.info">Î•Î´Ï Î¸Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚ Ï€Î¿Ï… Î­Ï‡ÎµÏ„Îµ ÎºÎ¬Î½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÎ±Ï‚.</p>
    </div>
  </div>

  <footer>
    <a href="/index.html"><i class="fas fa-home"></i><span data-i18n="nav.home">Home</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('aboutOverlay')"><i class="fas fa-info-circle"></i><span data-i18n="nav.about">About Us</span></a>
    <a href="javascript:void(0)" class="central-btn"><i class="fas fa-bell"></i><span data-i18n="nav.book">ÎšÏÎ¬Ï„Î·ÏƒÎ·</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('aiOverlay')"><i class="fas fa-comments"></i><span data-i18n="nav.ai">AI Assistant</span></a>
    <a href="javascript:void(0)" onclick="openOverlay('profileOverlay')"><i class="fas fa-user"></i><span data-i18n="nav.profile">Î ÏÎ¿Ï†Î¯Î»</span></a>
  </footer>

  <!-- Load i18n first and add cache-busting -->
  <script src="/js/i18n.js?v=20251022" defer></script>
  <script src="/js/overlay-manager.js?v=2" defer></script>
  <script src="/js/assistant.js?v=2" defer></script>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // Safe i18n accessor: if translation not ready or equals key, return fallback
      function tSafe(key, fallback){
        try { const v = (window.t && window.t(key)) || ''; return (v && v !== key) ? v : fallback; } catch(_){ return fallback; }
      }

      // Title
      try {
        const t = sessionStorage.getItem('gw_trip_title') || '';
        if (t) document.getElementById('s3TripTitle').textContent = t;
      } catch(_){}

      const get = (k, d='')=>{ 
        try { 
          let v = sessionStorage.getItem(k);
          if (v == null) v = localStorage.getItem(k);
          return v == null ? d : v; 
        } catch(_){ return d; } 
      };
  const langFlags = { el:'ğŸ‡¬ğŸ‡·', en:'ğŸ‡¬ğŸ‡§', fr:'ğŸ‡«ğŸ‡·', de:'ğŸ‡©ğŸ‡ª', it:'ğŸ‡®ğŸ‡¹', es:'ğŸ‡ªğŸ‡¸', zh:'ğŸ‡¨ğŸ‡³', he:'ğŸ‡®ğŸ‡±', nl:'ğŸ‡³ğŸ‡±', sv:'ğŸ‡¸ğŸ‡ª', ko:'ğŸ‡°ğŸ‡·', pt:'ğŸ‡µğŸ‡¹', ru:'ğŸ‡·ğŸ‡º' };
  const travTypeFallback = { explore:'Î•Î¾ÎµÏÎµÏ…Î½Î·Ï„Î­Ï‚ â€“ Î´ÏÎ±ÏƒÏ„Î®ÏÎ¹Î¿Î¹', relax:'Î§Î±Î»Î±ÏÎ¿Î¯ Ï„Î±Î¾Î¹Î´Î¹ÏÏ„ÎµÏ‚', family:'ÎŸÎ¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏŒ ÏÏ†Î¿Ï‚', solo:'ÎœÎ¿Î½Î±Ï‡Î¹ÎºÎ¿Î¯ Ï„Î±Î¾Î¹Î´Î¹ÏÏ„ÎµÏ‚' };
  const interestFallback = { nature:'Î¦ÏÏƒÎ·', culture:'Î Î¿Î»Î¹Ï„Î¹ÏƒÎ¼ÏŒÏ‚', mountain:'Î’Î¿Ï…Î½ÏŒ', sea:'Î˜Î¬Î»Î±ÏƒÏƒÎ±', gastronomy:'Î“Î±ÏƒÏ„ÏÎ¿Î½Î¿Î¼Î¯Î±' };
  const langFallbackLabels = { el:'Î•Î»Î»Î·Î½Î¹ÎºÎ¬', en:'English', fr:'FranÃ§ais', de:'Deutsch', it:'Italiano', es:'EspaÃ±ol', zh:'ä¸­æ–‡', he:'×¢×‘×¨×™×ª', nl:'Nederlands', sv:'Svenska', ko:'í•œêµ­ì–´', pt:'PortuguÃªs', ru:'Ğ ÑƒÑÑĞºĞ¸Ğ¹' };

      const adults = get('gw_adults','2');
      const ages = (()=>{ try { return JSON.parse(get('gw_children_ages','[]')); } catch(_){ return []; } })();
      const children = String(ages.length);
      const bagsL = get('gw_bags_large','0');
      const bagsS = get('gw_bags_small','0');
  // Communication preference: prefer explicit booking preference, fallback to global UI language
  const langC = (() => { const v = get('gw_pref_lang',''); return v || get('gw_lang','el'); })();
      const ageG = get('gw_age_group','');
      const travT = get('gw_traveler_type','');
      const interest = get('gw_interest','');
      const social = get('gw_sociality','');

      function renderValues(){
        document.getElementById('vAdults').textContent = adults;
        document.getElementById('vChildren').textContent = children;
        document.getElementById('vChildrenAges').textContent = ages.length? ages.join(', '): 'â€”';
        document.getElementById('vBagsLarge').textContent = bagsL;
        document.getElementById('vBagsSmall').textContent = bagsS;
        const langLabel = tSafe('booking.preferred_language_options.' + langC, (langFallbackLabels[langC] || langC.toUpperCase()));
        const langFlag = langFlags[langC] || '';
        document.getElementById('vLang').textContent = langLabel ? (langFlag ? `${langFlag} ${langLabel}` : langLabel) : 'â€”';
        document.getElementById('vAgeGroup').textContent = ageG || 'â€”';
        const travLabel = travT ? tSafe('booking.traveler_type_options.' + travT, (travTypeFallback[travT] || 'â€”')) : 'â€”';
        const intLabel = interest ? tSafe('booking.interests_options.' + interest, (interestFallback[interest] || 'â€”')) : 'â€”';
        const socLabel = social ? tSafe('booking.sociality_options.' + social, (social === 'social' ? 'ÎšÎ¿Î¹Î½Ï‰Î½Î¹ÎºÏŒÏ‚' : social === 'quiet' ? 'Î‰ÏƒÏ…Ï‡Î¿Ï‚' : 'â€”')) : 'â€”';
        document.getElementById('vTravelerType').textContent = travLabel;
        document.getElementById('vInterest').textContent = intLabel;
        document.getElementById('vSocial').textContent = socLabel;
      }
      renderValues();

      document.getElementById('s3Back')?.addEventListener('click', ()=> history.back());
      document.getElementById('s3Finish')?.addEventListener('click', (ev)=>{
        try { ev.preventDefault(); } catch(_){ }
        // could post or navigate to checkout
        try {
          const origin = (window.location && window.location.origin) || (window.location.protocol + '//' + window.location.host) || '';
          const absUrl = origin ? (new URL('/checkout.html', origin).href) : '/checkout.html';
          try { window.location.assign(absUrl); }
          catch(_e1){ try { window.location.href = absUrl; } catch(_e2){ setTimeout(()=>{ window.location.href = '/checkout.html'; }, 0); } }
        } catch(_){ window.location.href = '/checkout.html'; }
      });

      // Ensure labels translate after i18n is ready and on future language changes
      try { if (window.currentI18n && window.setLanguage) window.setLanguage(window.currentI18n.lang); } catch(_){ }
      try { setTimeout(()=>{ if (window.currentI18n && window.setLanguage) window.setLanguage(window.currentI18n.lang); }, 60); } catch(_){ }
      try {
        window.addEventListener('i18n:changed', ()=>{ try { renderValues(); } catch(_){ } });
      } catch(_){ }
    });
  </script>
  <script src="/js/feedback.js" defer></script>
  <script>try{ window.GWFeedbackPrompt && window.GWFeedbackPrompt.init && window.GWFeedbackPrompt.init(); }catch(e){}</script>
</body>
</html>
