<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Greekaway â€“ Î•ÎºÎ´ÏÎ¿Î¼Î®</title>

  <!-- Icons + Î²Î±ÏƒÎ¹ÎºÏŒ style ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ welcome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/trip.css?v=20251121-3">
  <link rel="stylesheet" href="/css/booking.css">
  <link rel="stylesheet" href="/css/notification-bubble.css?v=20251108">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#001f3f">
  <link rel="stylesheet" href="/pwa.css">
  <link rel="stylesheet" href="/css/pwa-fixes.css">

  <!-- ÎšÏÏÎ¹Î¿Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ -->
  <!-- Flatpickr (dark theme) for cinematic date picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <!-- Flatpickr locales: Greek + common site languages for calendar month/day names -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/gr.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/de.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/he.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/it.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/nl.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/sv.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh.js"></script>
  <script src="/js/carousel-config.js"></script>
  <!-- Load i18n early so booking/labels can translate immediately -->
  <script src="/js/i18n.js?v=20251022" defer></script>
  <script src="/js/booking-reset.js?v=20251120" defer></script>
  <!-- App logic (cache-busted) -->
  <script src="/js/main.js?v=20251022" defer></script>
  <!-- Trip-only: iPhone-style notification bubble (fake for now) -->
  <script src="/js/notification-bubble.js" defer></script>
  <script src="/pwa-install.js" defer></script>
  <!-- Share trip-mode logic so Step 1 can also style mode-specific UI -->
  <script src="/js/step2-trip-mode.js" defer></script>
  <script>
    // Persist trip_mode from URL (default to van) for Step 2
    (function(){
      try {
        const params = new URLSearchParams(window.location.search);
        let mode = (params.get('mode') || localStorage.getItem('trip_mode') || 'van').toLowerCase();
        const allowed = ['van','private','bus','mercedes'];
        if (!allowed.includes(mode)) mode = 'van';
        if (mode === 'mercedes') mode = 'private';
        localStorage.setItem('trip_mode', mode);
      } catch(_) {}
    })();
    // Capture official bus departure reference point name for Step 2 auto pickup
    (function(){
      function storeBusPickup(){
        try {
          const mode = (localStorage.getItem('trip_mode')||'').toLowerCase();
          if (mode !== 'bus') return;
          const trip = window.__loadedTrip;
          const depName = trip && trip.departure && trip.departure.reference_point && trip.departure.reference_point.name;
          if (depName && depName.trim()) {
            localStorage.setItem('bus_pickup_address', depName.trim());
          }
        } catch(_){ }
      }
      // Poll until trip data is loaded or timeout
      let tries = 0;
      const iv = setInterval(()=>{
        tries++; storeBusPickup();
        if (window.__loadedTrip || tries > 60) clearInterval(iv);
      }, 100);
      document.addEventListener('i18n:changed', storeBusPickup);
    })();
  </script>
</head>

<body class="trip-page">
  <nav id="tripInfoTabs" class="trip-info-tabs" aria-label="Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎºÎ´ÏÎ¿Î¼Î®Ï‚" role="toolbar">
    <button type="button" class="trip-info-tab" data-info-key="home">Î‘ÏÏ‡Î¹ÎºÎ®</button>
    <button type="button" class="trip-info-tab" data-info-key="includes">Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹</button>
    <button type="button" class="trip-info-tab" data-info-key="excludes">Î”ÎµÎ½ Î ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹</button>
    <button type="button" class="trip-info-tab" data-info-key="experience">Î•Î¼Ï€ÎµÎ¹ÏÎ¯Î±</button>
    <button type="button" class="trip-info-tab" data-info-key="faq">Î£Ï…Ï‡Î½Î­Ï‚ Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚</button>
    <button type="button" class="trip-info-tab" data-info-key="assistant">Î¡Ï‰Ï„Î®ÏƒÏ„Îµ Ï„Î¿Î½ Î’Î¿Î·Î¸ÏŒ</button>
  </nav>
  <!-- Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÎµÎºÎ´ÏÎ¿Î¼Î®Ï‚ -->
  <section id="trip-section" class="trip-section" data-active-mode="">
    <h2 id="trip-title"></h2>
    <!-- Trip header capsules: populated dynamically (price & time on top row, location below) -->
    <div class="trip-header-capsules" id="trip-meta" style="display:none"></div>
    <!-- Legacy single price (kept for backward compatibility, hidden by default) -->
    <div id="trip-price" class="price-tag" style="display:none">â€”</div>
    <p id="trip-subtitle" class="trip-subtitle" style="display:none"></p>
    <div id="trip-duration" class="trip-duration" style="display:none"></div>
    <div id="trip-tags" class="trip-tags" style="display:none"></div>
    <p id="trip-description"></p>

    <div id="trip-includes" class="trip-card trip-inclusions trip-info-source" aria-hidden="true" data-info-source="includes" style="display:none"></div>
    <div id="trip-sections" class="trip-sections trip-info-source" aria-hidden="true" data-info-source="experience"></div>
    <div id="trip-gallery" class="trip-card trip-gallery" style="display:none"></div>
    <div id="trip-video" class="trip-card trip-video" style="display:none"></div>
    <div id="trip-faq" class="trip-card trip-faq trip-info-source" aria-hidden="true" data-info-source="faq" style="display:none"></div>

    <div id="trip-map-card" class="trip-card trip-map-card" style="display:none">
      <h3 data-i18n="trip.map_heading">Î§Î¬ÏÏ„Î·Ï‚ & Î”Î¹Î±Î´ÏÎ¿Î¼Î®</h3>
      <div id="map" class="trip-map"></div>
    </div>
    <div id="stops" class="trip-stops"></div>

  </section>

  <!-- Overlays -->
  <div id="aiOverlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('aiOverlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.ai">AI Assistant</h2>
        <p data-i18n="welcome.ask">Î¡Ï‰Ï„Î®ÏƒÏ„Îµ Î¼Î±Ï‚ ÏŒ,Ï„Î¹ Î¸Î­Î»ÎµÏ„Îµ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎ´ÏÎ¿Î¼Î® ÏƒÎ±Ï‚!</p>
    </div>
  </div>

  <div id="profileOverlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('profileOverlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.profile">Î¤Î¿ Î ÏÎ¿Ï†Î¯Î» Î¼Î¿Ï…</h2>
        <p data-i18n="profile.info">Î•Î´Ï Î¸Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚ Ï€Î¿Ï… Î­Ï‡ÎµÏ„Îµ ÎºÎ¬Î½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÎ±Ï‚.</p>
    </div>
  </div>

  <div id="aboutOverlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('aboutOverlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="about.title">Î£Ï‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ ÎµÎ¼Î¬Ï‚</h2>
      <p data-i18n="about.text">Î¤Î¿ Greekaway Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î³Î¹Î± Î½Î± ÏƒÎ±Ï‚ Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½ÎµÏ‚ ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚ ÏƒÏ„Î·Î½ Î•Î»Î»Î¬Î´Î± Î¼Îµ Î¬Î½ÎµÏƒÎ·, Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± ÎºÎ±Î¹ ÏƒÏ„Ï…Î».</p>
    </div>
  </div>

  <div id="tripInfoOverlay" class="overlay" role="dialog" aria-modal="true">
    <div class="overlay-inner trip-info-overlay-inner">
      <div class="trip-info-overlay-content">
        <h2 id="tripInfoOverlayTitle">Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚</h2>
        <div id="tripInfoOverlayBody" class="trip-info-overlay-body"></div>
      </div>
    </div>
  </div>

  <div id="paymentOverlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('paymentOverlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner">
      <h2 data-i18n="nav.checkout">Î Î»Î·ÏÏ‰Î¼Î®</h2>
        <p data-i18n="checkout.info">Î— Ï†ÏŒÏÎ¼Î± Ï€Î»Î·ÏÏ‰Î¼Î®Ï‚ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÎµÎ´Ï.</p>
    </div>
  </div>

  <div id="bookingOverlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('bookingOverlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner">
      <h2 id="bookingOverlayTitle" data-i18n="booking.title">ÎšÏÎ¬Ï„Î·ÏƒÎ·</h2>
      <form id="bookingForm" class="booking-form">
        <input type="hidden" name="trip_id" id="bookingTripId">

        <div class="row">
          <label for="bookingDate" data-i18n="booking.date">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</label>
          <input id="bookingDate" name="date" type="date" required data-i18n-placeholder="booking.date_placeholder" placeholder="YYYY-MM-DD" />
        </div>
        <!-- Per-mode availability summary for chosen date -->
        <div id="modeAvailSummary" class="mode-avail-summary" style="display:none; font-size:0.85rem; line-height:1.4; margin-top:6px; background:#0b2538; padding:6px 8px; border-radius:6px;">
          <!-- populated dynamically: Bus: 12/40 â€¢ Van: 3/7 â€¢ Mercedes: 0/1 -->
        </div>

        <div class="row two-col">
          <div>
            <label for="bookingSeats" data-i18n="booking.seats">Î˜Î­ÏƒÎµÎ¹Ï‚</label>
            <div class="seat-control">
              <button type="button" class="seat-dec" data-i18n-aria="booking.decrease">ÎœÎµÎ¯Ï‰ÏƒÎ·</button>
              <input id="bookingSeats" name="seats" type="number" value="1" min="1" max="10" required />
              <button type="button" class="seat-inc" data-i18n-aria="booking.increase">Î‘ÏÎ¾Î·ÏƒÎ·</button>
            </div>
          </div>

          <div>
            <label for="bookingPrice" data-i18n="booking.total">Î£ÏÎ½Î¿Î»Î¿</label>
            <div id="bookingPrice" class="price-tag">â€”</div>
          </div>
        </div>

        <div class="row">
          <label for="bookingName" data-i18n="checkout.name">ÎŒÎ½Î¿Î¼Î±</label>
          <input id="bookingName" name="user_name" type="text" data-i18n-placeholder="booking.name_placeholder" placeholder="Full name" required />
        </div>

        <div class="row">
          <label for="bookingEmail" data-i18n="checkout.email">Email</label>
          <input id="bookingEmail" name="user_email" type="email" data-i18n-placeholder="booking.email_placeholder" placeholder="name@example.com" required />
        </div>

        <div class="row section-title"><h3 data-i18n="booking.traveler_profile">Î ÏÎ¿Ï†Î¯Î» Î¤Î±Î¾Î¹Î´Î¹ÏÏ„Î·</h3></div>
        <div class="row two-col">
          <div>
            <label for="travelerProfile" data-i18n="booking.traveler_type">Traveler Type</label>
            <select id="travelerProfile" name="travelerProfile">
              <option value="explorer" data-i18n="booking.traveler_type_options.explorer">ğŸŒ Explorers</option>
              <option value="relaxed" data-i18n="booking.traveler_type_options.relaxed">ğŸ˜Œ Relaxed Travelers</option>
              <option value="family" data-i18n="booking.traveler_type_options.family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Family Style</option>
              <option value="solo" data-i18n="booking.traveler_type_options.solo">ğŸš¶ Solo Adventurers</option>
            </select>
          </div>
          <div>
            <label for="travelStyle" data-i18n="booking.travel_style">Travel Style</label>
            <select id="travelStyle" name="travelStyle">
              <option value="sociable" data-i18n="booking.travel_style_options.sociable">ğŸ‘¥ Sociable</option>
              <option value="quiet" data-i18n="booking.travel_style_options.quiet">ğŸ¤« Quiet</option>
              <option value="cultural" data-i18n="booking.travel_style_options.cultural">ğŸ›ï¸ Cultural</option>
              <option value="nature" data-i18n="booking.travel_style_options.nature">ğŸŒ² Nature-oriented</option>
            </select>
          </div>
        </div>

        <div class="row two-col">
          <div>
            <label for="preferredLanguage" data-i18n="booking.preferred_language">Î ÏÎ¿Ï„Î¹Î¼ÏÎ¼ÎµÎ½Î· Î“Î»ÏÏƒÏƒÎ±</label>
            <select id="preferredLanguage" name="preferredLanguage">
              <option value="en" data-i18n="booking.preferred_language_options.en">ğŸ‡¬ğŸ‡§ English</option>
              <option value="fr" data-i18n="booking.preferred_language_options.fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
              <option value="de" data-i18n="booking.preferred_language_options.de">ğŸ‡©ğŸ‡ª Deutsch</option>
              <option value="el" data-i18n="booking.preferred_language_options.el">ğŸ‡¬ğŸ‡· Î•Î»Î»Î·Î½Î¹ÎºÎ¬</option>
              <option value="it" data-i18n="booking.preferred_language_options.it">ğŸ‡®ğŸ‡¹ Italiano</option>
              <option value="es" data-i18n="booking.preferred_language_options.es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
              <option value="zh" data-i18n="booking.preferred_language_options.zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
              <option value="he" data-i18n="booking.preferred_language_options.he">ğŸ‡®ğŸ‡± ×¢×‘×¨×™×ª</option>
              <option value="nl" data-i18n="booking.preferred_language_options.nl">ğŸ‡³ğŸ‡± Nederlands</option>
              <option value="sv" data-i18n="booking.preferred_language_options.sv">ğŸ‡¸ğŸ‡ª Svenska</option>
              <option value="ko" data-i18n="booking.preferred_language_options.ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
              <option value="pt" data-i18n="booking.preferred_language_options.pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
              <option value="ru" data-i18n="booking.preferred_language_options.ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
          </div>
          <div>
            <label for="travelTempo" data-i18n="booking.daily_rhythm">Î£Ï„Ï…Î» ÎÏÎ±Ï‚ / Î—Î¼Î­ÏÎ±Ï‚</label>
            <select id="travelTempo" name="travelTempo">
              <option value="early" data-i18n="booking.daily_rhythm_options.early">ğŸŒ… Early riser</option>
              <option value="night" data-i18n="booking.daily_rhythm_options.night">ğŸŒ™ Night type</option>
              <option value="talkative" data-i18n="booking.daily_rhythm_options.talkative">ğŸ’¬ Talkative</option>
              <option value="reserved" data-i18n="booking.daily_rhythm_options.reserved">ğŸ™Š Reserved</option>
            </select>
          </div>
        </div>

        <div class="row actions">
          <button class="btn" type="submit" data-i18n="booking.create">Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ ÎºÏÎ¬Ï„Î·ÏƒÎ·</button>
          <button type="button" class="btn ghost" onclick="closeOverlay('bookingOverlay')" data-i18n="ui.cancel">Î†ÎºÏ…ÏÎ¿</button>
        </div>
      </form>

      <div id="bookingResult" class="booking-result" style="display:none"></div>
    </div>
  </div>

  <!-- New light-blue overlay for Step 2 (details) -->
  <div id="step2Overlay" class="overlay" role="dialog" aria-modal="true">
    <button class="close-overlay" onclick="closeOverlay('step2Overlay')" data-i18n-aria="ui.close">Ã—</button>
    <div class="overlay-inner" id="step2OverlayInner">
      <!-- Step 2 content is injected dynamically -->
    </div>
  </div>

  <!-- ===== FOOTER ===== -->
  <footer>
    <a href="/index.html">
      <i class="fas fa-home"></i>
      <span data-i18n="nav.home">Home</span>
    </a>

    <a href="javascript:void(0)" onclick="openOverlay('aboutOverlay')">
      <i class="fas fa-info-circle"></i>
      <span data-i18n="nav.about">About Us</span>
    </a>

    <a href="javascript:void(0)" class="central-btn">
      <i class="fas fa-bell"></i>
      <span data-i18n="nav.book">Online ÎšÏÎ¬Ï„Î·ÏƒÎ·</span>
    </a>

    <a href="javascript:void(0)" onclick="openOverlay('aiOverlay')">
      <i class="fas fa-comments"></i>
      <span data-i18n="nav.ai">AI Assistant</span>
    </a>

    <a href="javascript:void(0)" onclick="openOverlay('profileOverlay')">
      <i class="fas fa-user"></i>
      <span data-i18n="nav.profile">Î ÏÎ¿Ï†Î¯Î»</span>
    </a>
  </footer>

  <script src="/js/overlay-manager.js" defer></script>
  <script src="/js/footer.js?v=20251021" defer></script>
  <script src="/js/assistant.js" defer></script>
  <script src="/js/trip.js?v=20251121" defer></script>

  <!-- Google Maps -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY"></script>
  <script>
    // Ensure central "Online ÎšÏÎ¬Ï„Î·ÏƒÎ·" button sends user to Step 2 with id, mode, date
    (function(){
      function getParams(){ try { return new URLSearchParams(window.location.search); } catch(_){ return new URLSearchParams(''); } }
      function getMode(){ try { const p=getParams(); return (p.get('mode') || localStorage.getItem('trip_mode') || 'van').toLowerCase(); } catch(_){ return 'van'; } }
      function getTripId(){ try { const p=getParams(); return (p.get('id')||'').trim(); } catch(_){ return ''; } }
      function getDate(){
        // Prefer explicit input#bookingDate if present; else any session value
        try { const inp = document.getElementById('bookingDate'); if (inp && inp.value) return inp.value; } catch(_){ }
        try { const s = sessionStorage.getItem('gw_trip_date'); if (s) return s; } catch(_){ }
        return '';
      }
      function goStep2(){
        const id = getTripId(); const mode = getMode(); const date = getDate();
        if (!id || !date) { try { alert('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±'); } catch(_){ } return; }
        const origin = (window.location && window.location.origin) || (window.location.protocol + '//' + window.location.host) || '';
        const url = new URL('/step2.html', origin || window.location.href);
        url.searchParams.set('id', id);
        url.searchParams.set('mode', mode);
        url.searchParams.set('date', date);
        try { window.location.assign(url.href); }
        catch(_e1){ try { window.location.href = url.href; } catch(_e2){ setTimeout(()=>{ window.location.href = url.href; }, 0); } }
      }
      document.addEventListener('DOMContentLoaded', function(){
        const cta = document.querySelector('footer .central-btn');
        if (cta) cta.addEventListener('click', function(ev){ try { ev.preventDefault(); } catch(_){ } goStep2(); });
        // Persist date selection changes to session for stability across refresh
        try {
          const inp = document.getElementById('bookingDate');
          if (inp) inp.addEventListener('change', function(){ try { sessionStorage.setItem('gw_trip_date', inp.value || ''); } catch(_){ } });
        } catch(_){ }
      });
    })();
  </script>
</body>
</html>